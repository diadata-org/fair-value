FROM golang:1.23 as build

# ARG GITHUB_TOKEN

# RUN git config --global --add url."https://${GITHUB_TOKEN}":@github.com/diadata-org/fair-value.insteadOf "https://github.com/diadata-org/fair-value"

# ENV GOPRIVATE=github.com/diadata-org/diaprotocol

WORKDIR $GOPATH/src/diadata-org/fair-value
COPY ./ ./

RUN go mod download
RUN go mod tidy

RUN go install


FROM gcr.io/distroless/base


COPY --from=build /go/bin/fair-value /bin/fairvaluefeeder

CMD ["fairvaluefeeder"]
